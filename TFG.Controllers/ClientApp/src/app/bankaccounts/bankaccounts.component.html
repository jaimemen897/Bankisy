<router-outlet></router-outlet>
<p-toast></p-toast>
<div class="flex justify-content-center align-items-center gap-4 m-5">
  <p-button label="Iniciar sesiÃ³n" icon="pi pi-sign-in" (onClick)="goToLogin()"
            class="p-button-primary"></p-button>
  <p-button label="Usuarios" icon="pi pi-user-plus" (onClick)="goToUsers()"
            class="p-button-success"></p-button>
</div>
<div class="card">
  <p-table [value]="bankAccounts" [lazy]="true" [paginator]="true" [showCurrentPageReport]="true"
           [rowsPerPageOptions]="[10, 25, 50]" (onLazyLoad)="lazyLoad($event)"
           [totalRecords]="totalRecords" [rows]="rows" [tableStyle]="{ 'min-width': '75rem' }"
           [globalFilterFields]="['iban', 'balance', 'accountType', 'isDeleted']">
    <ng-template pTemplate="header">
      <tr>
        <th style="width:22%">IBAN</th>
        <th style="width:22%">Tipo de cuenta</th>
        <th style="width:22%">Usuario</th>
        <th style="width:22%">Saldo</th>
        <th style="width:12%">Estado</th>
      </tr>
      <tr>
        <!--BUSCAR POR IBAN-->
        <th>
          <p-columnFilter type="text" field="iban" (input)="onSearch($event)" placeholder="Buscar por IBAN" [showMenu]="false"/>
        </th>
        <!--BUSCAR POR ACCOUNT TYPE-->
        <th>
          <p-columnFilter field="accountType" matchMode="in" [showMenu]="false">
            <ng-template pTemplate="filter" let-value>
              <p-dropdown [ngModel]="value" [options]="accountsTypes" (onChange)="onSearchFilter($event)" placeholder="Tipo de cuenta"
                          [showClear]="true" class="text-color-secondary">
                <ng-template let-option pTemplate="item">
                  <p-tag [value]="option" [severity]="getSeverity(option)"></p-tag>
                </ng-template>
              </p-dropdown>
            </ng-template>
          </p-columnFilter>
        </th>
        <!--BUSCAR POR USUARIO-->
        <th>
          <p-columnFilter field="users" matchMode="in" [showMenu]="false">
            <ng-template pTemplate="filter" let-value>
              <p-multiSelect [ngModel]="value" [options]="users" placeholder="Buscar por usuario"
                             (onChange)="onSearchUser($event)">
                <ng-template let-option pTemplate="item">
                  <div class="inline-block vertical-align-middle">
                    <img [alt]="option" src="https://icon-library.com/images/user-icon-flat/user-icon-flat-0.jpg" width="24" class="vertical-align-middle"/>
                    <span class="ml-1 mt-1">{{ option }}</span>
                  </div>
                </ng-template>
              </p-multiSelect>
            </ng-template>
          </p-columnFilter>
        </th>
        <!--BUSCAR POR SALDO-->
        <th>
          <p-columnFilter type="text" field="balance" (input)="onSearch($event)" placeholder="Buscar por saldo" [showMenu]="false"/>
        </th>
        <!--BUSCAR POR ESTADO-->
        <th>
          <p-columnFilter type="boolean" field="isDeleted" (input)="onSearch($event)" [showMenu]="false"/>
        </th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-account>
      <tr>
        <td>
          {{ account.iban }}
        </td>
        <td>
          <!--<img src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                           [class]="'flag flag-' + customer.country.code" style="width: 20px"/>
          <span class="ml-1 vertical-align-middle">{{ customer.country.name }}</span>-->
          <p-tag [value]="account.accountType" [severity]="getSeverity(account.accountType)"></p-tag>
        </td>
        <td>
          <!--<img [alt]="customer.representative.name"
                           src="https://primefaces.org/cdn/primeng/images/demo/avatar/{{ customer.representative.image }}"
                           width="32" style="vertical-align: middle"/>
          <span class="ml-1 vertical-align-middle">{{ customer.representative.name }}</span>-->
          {{ account.usersName }}
        </td>
        <td>
          <p-tag [value]="account.balance.toString()" [severity]="getBalanceColor(account.balance)"/>
        </td>
        <td>
          <i class="pi"
             [ngClass]="{ 'text-green-500 pi-check-circle': !account.isDeleted, 'text-red-500 pi-times-circle': account.isDeleted }"></i>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="5">No se han encontrado cuentas bancarias</td>
      </tr>
    </ng-template>
  </p-table>
</div>
