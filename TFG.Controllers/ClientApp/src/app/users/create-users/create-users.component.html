<div class="card flex justify-content-center align-items-center overflow-visible">
  <div class="flex flex-column gap-3">
    <form [formGroup]="formGroup" class="flex flex-column gap-3">
      <div class="inline-flex flex-column gap-4 m-3">

        <div class="inline-flex gap-3 mt-2">
          <div>
            <span class="p-input-filled">
              <input class="p-3 border-round-3xl border-0 bg-secondary" formControlName="name" id="name" pInputText
                     placeholder="Nombre"
                     type="text">
              </span>
            @if (formGroup.controls['name'].invalid && formGroup.controls['name'].touched) {
              @if (formGroup.controls['name'].errors?.required) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El nombre es obligatorio</p>
              }
              @if (formGroup.controls['name'].errors?.minlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El nombre debe tener al menos 3 caracteres</p>
              }
              @if (formGroup.controls['name'].errors?.maxlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El nombre debe tener como máximo 50 caracteres</p>
              }
            }
          </div>

          <div>
              <span class="p-input-filled">
                <input class="p-3 border-round-3xl border-0 bg-secondary" formControlName="email" id="email" pInputText
                       placeholder="Email"
                       type="text">
                </span>
            @if (formGroup.controls['email'].invalid && formGroup.controls['email'].touched) {
              @if (formGroup.controls['email'].errors?.required) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El email es obligatorio</p>
              }
              @if (formGroup.controls['email'].errors?.email) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El email no es válido</p>
              }
            }
          </div>
        </div>

        <div class="inline-flex gap-3">
          <div><span class="p-input-filled">
                <input class="p-3 border-round-3xl border-0 bg-secondary" formControlName="username" id="username"
                       pInputText placeholder="Username"
                       type="text">
                </span>
            @if (formGroup.controls['username'].invalid && formGroup.controls['username'].touched) {
              @if (formGroup.controls['username'].errors?.required) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El username es obligatorio</p>
              }
              @if (formGroup.controls['username'].errors?.minlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El username debe tener al menos 3 caracteres</p>
              }
              @if (formGroup.controls['username'].errors?.maxlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El username debe tener como máximo 50 caracteres</p>
              }
            }</div>

          <div><span class="p-input-filled">
                  <input (input)="validateDNI($event)" class="p-3 border-round-3xl border-0 bg-secondary"
                         formControlName="dni" id="dni" pInputText placeholder="DNI"
                         type="text">
                  </span>
            @if (formGroup.controls['dni'].invalid && formGroup.controls['dni'].touched) {
              @if (formGroup.controls['dni'].errors?.required) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El DNI es obligatorio</p>
              }
              @if (formGroup.controls['dni'].errors?.minlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El DNI debe tener 9 caracteres</p>
              }
              @if (formGroup.controls['dni'].errors?.maxlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El DNI debe tener 9 caracteres</p>
              }
              @if (formGroup.controls['dni'].errors?.incorrect) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El DNI no es correcto</p>
              }
            }</div>
        </div>

        <div class="inline-flex gap-3">
          <div>
                    <span class="p-input-filled">
                      <input class="p-3 border-round-3xl border-0 bg-secondary" formControlName="phone" id="phone"
                             pInputText
                             placeholder="Teléfono"
                             type="text">
                      </span>
            @if (formGroup.controls['phone'].invalid && formGroup.controls['phone'].touched) {
              @if (formGroup.controls['phone'].errors?.required) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El teléfono es obligatorio</p>
              }
              @if (formGroup.controls['phone'].errors?.minlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El teléfono debe tener 9 caracteres</p>
              }
              @if (formGroup.controls['phone'].errors?.maxlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El teléfono debe tener 9 caracteres</p>
              }
            }
          </div>

          <div class="flex flex-column gap-2">
            <p-dropdown [options]="genders" formControlName="gender" placeholder="Selecciona un género"
                        styleClass="w-16rem"/>
            @if (formGroup.controls['gender'].invalid && formGroup.controls['gender'].touched) {
              @if (formGroup.controls['gender'].errors?.required) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  El género es obligatorio</p>
              }
            }
          </div>
        </div>

        <div class="inline-flex gap-3">
          <div>
                        <span class="p-input-filled">
                          <p-password class="border-round-3xl border-0 bg-secondary w-full"
                                      formControlName="password" id="password" mediumLabel="Media"
                                      placeholder="Contraseña"
                                      promptLabel="Introduce una contraseña" strongLabel="Fuerte" toggleMask
                                      weakLabel="Débil"/>
                          </span>
            @if (formGroup.controls['password'].invalid && formGroup.controls['password'].touched) {
              @if (formGroup.controls['password'].errors?.required) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  La contraseña es obligatoria</p>
              }
              @if (formGroup.controls['password'].errors?.minlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  La contraseña debe tener al menos 3 caracteres</p>
              }
              @if (formGroup.controls['password'].errors?.maxlength) {
                <p class="text-red-500 text-xs m-0 ml-3">
                  La contraseña debe tener como máximo 50 caracteres</p>
              }
            }
          </div>

          <div>
                          <span class="p-input-filled">
                            <p-password class="border-round-3xl border-0 bg-secondary w-full"
                                        formControlName="confirmpassword" id="confirmpassword" mediumLabel="Media"
                                        placeholder="Confirmar contraseña" promptLabel="Confirma tu contraseña"
                                        strongLabel="Fuerte"
                                        toggleMask weakLabel="Débil"/>
                            </span>
            @if (formGroup.errors?.passwordMismatch && formGroup.controls['confirmpassword'].touched) {
              <p class="text-red-500 text-xs m-0 ml-3">
                Las contraseñas no coinciden
              </p>
            }
          </div>
        </div>

        <div class="flex flex-column mt-4 gap-2">
          <p-button (click)="saveChanges()" [label]="label" rounded styleClass="w-full"></p-button>
          <p-button (click)="cancel()" label="Cancelar" rounded severity="secondary" styleClass="w-full"></p-button>
        </div>
      </div>
    </form>
  </div>
</div>
